{
  "id": "lab-4-agent-loop",
  "title": "Build Agent Loop",
  "description": "Create a complete agent loop with reasoning and tool use",
  "difficulty": "advanced",
  "estimatedMinutes": 60,
  "language": "javascript",
  "starterCode": "/**\n * Agent loop that reasons and uses tools\n * @param {string} task - Task to accomplish\n * @param {Array} tools - Available tools\n * @param {number} maxIterations - Max loop iterations\n * @returns Final answer\n */\nasync function agentLoop(task, tools, maxIterations = 5) {\n  // Your code here\n  // 1. Start with the task\n  // 2. Agent thinks about next action\n  // 3. Execute tool if needed\n  // 4. Update context with result\n  // 5. Repeat until done or max iterations\n  // 6. Return final answer\n  return ''\n}\n\n/**\n * Mock function to get agent's next action\n */\nfunction getAgentAction(context, tools) {\n  // Simulates LLM deciding what to do next\n  return {\n    thought: 'I need to search for information',\n    action: 'search',\n    actionInput: { query: 'example' },\n    finished: false\n  }\n}\n",
  "instructions": "Build a complete agent loop that:\n1. Maintains conversation context (task, tool results, thoughts)\n2. Calls getAgentAction() to decide next step\n3. Executes tools when action is specified\n4. Adds results to context\n5. Continues until agent sets finished: true or maxIterations reached\n6. Returns the final answer\n\nThe loop should handle multiple iterations of: Think → Act → Observe",
  "testCases": [
    {
      "input": "agentLoop('test task', [], 1).includes('answer')",
      "expectedOutput": "true",
      "description": "Returns an answer"
    },
    {
      "input": "typeof await agentLoop('test', [], 1)",
      "expectedOutput": "string",
      "description": "Returns a string result"
    },
    {
      "input": "(await agentLoop('test', [], 1)).length > 0",
      "expectedOutput": "true",
      "description": "Returns non-empty result"
    },
    {
      "input": "await agentLoop('task', [], 0) !== undefined",
      "expectedOutput": "true",
      "description": "Handles zero iterations"
    },
    {
      "input": "await agentLoop('task', [], 3) !== undefined",
      "expectedOutput": "true",
      "description": "Respects max iteration limit"
    }
  ],
  "hints": [
    "Use a while loop with iteration counter",
    "Build context as array of {role, content} messages",
    "Check getAgentAction().finished to break loop",
    "Handle tool execution similar to Lab 2"
  ]
}
